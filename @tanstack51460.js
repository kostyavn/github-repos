import{i as K}from"./tiny-invariant51460.js";import{w as Tt}from"./tiny-warning51460.js";import{r as S,j as y}from"./react51460.js";import{r as ie}from"./react-dom51460.js";import{w as ae}from"./use-sync-external-store51460.js";const Nt="pushstate",zt="popstate",Jt="beforeunload",Xt=t=>(t.preventDefault(),t.returnValue=""),ce=()=>{removeEventListener(Jt,Xt,{capture:!0})};function Qt(t){let o=t.getLocation();const e=new Set;let n=[];const r=()=>{o=t.getLocation(),e.forEach(s=>s())},i=async(s,a)=>{var u;if(!((a==null?void 0:a.ignoreBlocker)??!1)&&typeof document<"u"&&n.length){for(const l of n)if(!await l()){(u=t.onBlocked)==null||u.call(t,r);return}}s()};return{get location(){return o},get length(){return t.getLength()},subscribers:e,subscribe:s=>(e.add(s),()=>{e.delete(s)}),push:(s,a,u)=>{a=Dt(a),i(()=>{t.pushState(s,a),r()},u)},replace:(s,a,u)=>{a=Dt(a),i(()=>{t.replaceState(s,a),r()},u)},go:(s,a)=>{i(()=>{t.go(s),r()},a)},back:s=>{i(()=>{t.back(),r()},s)},forward:s=>{i(()=>{t.forward(),r()},s)},createHref:s=>t.createHref(s),block:s=>(n.push(s),n.length===1&&addEventListener(Jt,Xt,{capture:!0}),()=>{n=n.filter(a=>a!==s),n.length||ce()}),flush:()=>{var s;return(s=t.flush)==null?void 0:s.call(t)},destroy:()=>{var s;return(s=t.destroy)==null?void 0:s.call(t)},notify:r}}function Dt(t){return t||(t={}),{...t,key:de()}}function le(t){const o=typeof document<"u"?window:void 0,e=o.history.pushState,n=o.history.replaceState,r=g=>g,i=()=>bt(`${o.location.pathname}${o.location.search}${o.location.hash}`,o.history.state);let s=i(),a;const u=()=>s;let c,l;const d=()=>{c&&(p._ignoreSubscribers=!0,(c.isPush?o.history.pushState:o.history.replaceState)(c.state,"",c.href),p._ignoreSubscribers=!1,c=void 0,l=void 0,a=void 0)},h=(g,m,x)=>{const L=r(m);l||(a=s),s=bt(m,x),c={href:L,state:x,isPush:(c==null?void 0:c.isPush)||g==="push"},l||(l=Promise.resolve().then(()=>d()))},f=()=>{s=i(),p.notify()},p=Qt({getLocation:u,getLength:()=>o.history.length,pushState:(g,m)=>h("push",g,m),replaceState:(g,m)=>h("replace",g,m),back:()=>o.history.back(),forward:()=>o.history.forward(),go:g=>o.history.go(g),createHref:g=>r(g),flush:d,destroy:()=>{o.history.pushState=e,o.history.replaceState=n,o.removeEventListener(Nt,f),o.removeEventListener(zt,f)},onBlocked:g=>{a&&s!==a&&(s=a,g())}});return o.addEventListener(Nt,f),o.addEventListener(zt,f),o.history.pushState=function(...g){const m=e.apply(o.history,g);return p._ignoreSubscribers||f(),m},o.history.replaceState=function(...g){const m=n.apply(o.history,g);return p._ignoreSubscribers||f(),m},p}function ue(t={initialEntries:["/"]}){const o=t.initialEntries;let e=t.initialIndex??o.length-1;const n=o.map(()=>({}));return Qt({getLocation:()=>bt(o[e],n[e]),getLength:()=>o.length,pushState:(i,s)=>{e<o.length-1&&(o.splice(e+1),n.splice(e+1)),n.push(s),o.push(i),e=Math.max(o.length-1,0)},replaceState:(i,s)=>{n[e]=s,o[e]=i},back:()=>{e=Math.max(e-1,0)},forward:()=>{e=Math.min(e+1,o.length-1)},go:i=>{e=Math.min(Math.max(e+i,0),o.length-1)},createHref:i=>i})}function bt(t,o){const e=t.indexOf("#"),n=t.indexOf("?");return{href:t,pathname:t.substring(0,e>0?n>0?Math.min(e,n):e:n>0?n:t.length),hash:e>-1?t.substring(e):"",search:n>-1?t.slice(n,e===-1?void 0:e):"",state:o||{}}}function de(){return(Math.random()+1).toString(36).substring(7)}const Et=S.createContext(null);function Yt(){return typeof document>"u"?Et:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=Et,Et)}function et(t){const o=S.useContext(Yt());return Tt(!(((t==null?void 0:t.warn)??!0)&&!o)),o}class he{constructor(o,e){this.listeners=new Set,this._batching=!1,this._flushing=0,this.subscribe=n=>{var r,i;this.listeners.add(n);const s=(i=(r=this.options)==null?void 0:r.onSubscribe)==null?void 0:i.call(r,n,this);return()=>{this.listeners.delete(n),s==null||s()}},this.setState=n=>{var r,i,s;const a=this.state;this.state=(r=this.options)!=null&&r.updateFn?this.options.updateFn(a)(n):n(a),(s=(i=this.options)==null?void 0:i.onUpdate)==null||s.call(i),this._flush()},this._flush=()=>{if(this._batching)return;const n=++this._flushing;this.listeners.forEach(r=>{this._flushing===n&&r()})},this.batch=n=>{if(this._batching)return n();this._batching=!0,n(),this._batching=!1,this._flush()},this.state=o,this.options=e}}function fe(t,o=e=>e){return ae.useSyncExternalStoreWithSelector(t.subscribe,()=>t.state,()=>t.state,o,pe)}function pe(t,o){if(Object.is(t,o))return!0;if(typeof t!="object"||t===null||typeof o!="object"||o===null)return!1;const e=Object.keys(t);if(e.length!==Object.keys(o).length)return!1;for(let n=0;n<e.length;n++)if(!Object.prototype.hasOwnProperty.call(o,e[n])||!Object.is(t[e[n]],o[e[n]]))return!1;return!0}const G="__root__";function me(t,o){let e,n,r,i="";for(e in t)if((r=t[e])!==void 0)if(Array.isArray(r))for(n=0;n<r.length;n++)i&&(i+="&"),i+=encodeURIComponent(e)+"="+encodeURIComponent(r[n]);else i&&(i+="&"),i+=encodeURIComponent(e)+"="+encodeURIComponent(r);return""+i}function $t(t){if(!t)return"";const o=decodeURIComponent(t);return o==="false"?!1:o==="true"?!0:+o*0===0&&+o+""===o?+o:o}function ve(t,o){let e,n;const r={},i=t.split("&");for(;e=i.shift();){const s=e.indexOf("=");if(s!==-1){n=e.slice(0,s),n=decodeURIComponent(n);const a=e.slice(s+1);r[n]!==void 0?r[n]=[].concat(r[n],$t(a)):r[n]=$t(a)}else n=e,n=decodeURIComponent(n),r[n]=""}return r}const ge=_e(JSON.parse),ye=Pe(JSON.stringify,JSON.parse);function _e(t){return o=>{o.substring(0,1)==="?"&&(o=o.substring(1));const e=ve(o);for(const n in e){const r=e[n];if(typeof r=="string")try{e[n]=t(r)}catch{}}return e}}function Pe(t,o){function e(n){if(typeof n=="object"&&n!==null)try{return t(n)}catch{}else if(typeof n=="string"&&typeof o=="function")try{return o(n),t(n)}catch{}return n}return n=>{n={...n},Object.keys(n).forEach(i=>{const s=n[i];typeof s>"u"||s===void 0?delete n[i]:n[i]=e(s)});const r=me(n).toString();return r?`?${r}`:""}}function mt(t){return t[t.length-1]}function Se(t){return typeof t=="function"}function ct(t,o){return Se(t)?t(o):t}function vt(t,o){return o.reduce((e,n)=>(e[n]=t[n],e),{})}function it(t,o){if(t===o)return t;const e=o,n=Ut(t)&&Ut(e);if(n||ut(t)&&ut(e)){const r=n?t:Object.keys(t),i=r.length,s=n?e:Object.keys(e),a=s.length,u=n?[]:{};let c=0;for(let l=0;l<a;l++){const d=n?l:s[l];(!n&&r.includes(d)||n)&&t[d]===void 0&&e[d]===void 0?(u[d]=void 0,c++):(u[d]=it(t[d],e[d]),u[d]===t[d]&&t[d]!==void 0&&c++)}return i===a&&c===i?t:u}return e}function ut(t){if(!Kt(t))return!1;const o=t.constructor;if(typeof o>"u")return!0;const e=o.prototype;return!(!Kt(e)||!e.hasOwnProperty("isPrototypeOf"))}function Kt(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ut(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Vt(t,o){let e=Object.keys(t);return o&&(e=e.filter(n=>t[n]!==void 0)),e}function lt(t,o,e){if(t===o)return!0;if(typeof t!=typeof o)return!1;if(ut(t)&&ut(o)){const n=(e==null?void 0:e.ignoreUndefined)??!0,r=Vt(t,n),i=Vt(o,n);return!(e!=null&&e.partial)&&r.length!==i.length?!1:i.every(s=>lt(t[s],o[s],e))}return Array.isArray(t)&&Array.isArray(o)?t.length!==o.length?!1:!t.some((n,r)=>!lt(n,o[r],e)):!1}const pt=typeof window<"u"?S.useLayoutEffect:S.useEffect;function at(t){let o,e;const n=new Promise((r,i)=>{o=r,e=i});return n.status="pending",n.resolve=r=>{n.status="resolved",n.value=r,o(r),t==null||t(r)},n.reject=r=>{n.status="rejected",e(r)},n}function It(t){const o=S.useRef({value:t,prev:null}),e=o.current.value;return t!==e&&(o.current={value:t,prev:e}),o.current.prev}function be(t,o,e={},n={}){const r=S.useRef(typeof IntersectionObserver=="function"),i=S.useRef(null);return S.useEffect(()=>{if(!(!t.current||!r.current||n.disabled))return i.current=new IntersectionObserver(([s])=>{o(s)},e),i.current.observe(t.current),()=>{var s;(s=i.current)==null||s.disconnect()}},[o,e,n.disabled,t]),i.current}function Le(t){const o=S.useRef(null);return S.useEffect(()=>{t&&(typeof t=="function"?t(o.current):t.current=o.current)}),o}function Y(t){return wt(t.filter(o=>o!==void 0).join("/"))}function wt(t){return t.replace(/\/{2,}/g,"/")}function jt(t){return t==="/"?t:t.replace(/^\/{1,}/,"")}function st(t){return t==="/"?t:t.replace(/\/{1,}$/,"")}function Ce(t){return st(jt(t))}function Lt(t,o){return t.endsWith("/")&&t!=="/"&&t!==`${o}/`?t.slice(0,-1):t}function we(t,o,e){return Lt(t,e)===Lt(o,e)}function xe({basepath:t,base:o,to:e,trailingSlash:n="never",caseSensitive:r}){var i,s;o=Ct(t,o,r),e=Ct(t,e,r);let a=dt(o);const u=dt(e);a.length>1&&((i=mt(a))==null?void 0:i.value)==="/"&&a.pop(),u.forEach((l,d)=>{l.value==="/"?d?d===u.length-1&&a.push(l):a=[l]:l.value===".."?a.pop():l.value==="."||a.push(l)}),a.length>1&&(((s=mt(a))==null?void 0:s.value)==="/"?n==="never"&&a.pop():n==="always"&&a.push({type:"pathname",value:"/"}));const c=Y([t,...a.map(l=>l.value)]);return wt(c)}function dt(t){if(!t)return[];t=wt(t);const o=[];if(t.slice(0,1)==="/"&&(t=t.substring(1),o.push({type:"pathname",value:"/"})),!t)return o;const e=t.split("/").filter(Boolean);return o.push(...e.map(n=>n==="$"||n==="*"?{type:"wildcard",value:n}:n.charAt(0)==="$"?{type:"param",value:n}:{type:"pathname",value:decodeURI(n)})),t.slice(-1)==="/"&&(t=t.substring(1),o.push({type:"pathname",value:"/"})),o}function _t({path:t,params:o,leaveWildcards:e,leaveParams:n}){const r=dt(t),i={};for(const[s,a]of Object.entries(o)){const u=typeof a=="string";["*","_splat"].includes(s)?i[s]=u?encodeURI(a):a:i[s]=u?encodeURIComponent(a):a}return Y(r.map(s=>{if(s.type==="wildcard"){const a=i._splat;return e?`${s.value}${a??""}`:a}if(s.type==="param"){if(n){const a=i[s.value];return`${s.value}${a??""}`}return i[s.value.substring(1)]??"undefined"}return s.value}))}function Pt(t,o,e){const n=Me(t,o,e);if(!(e.to&&!n))return n??{}}function Ct(t,o,e=!1){const n=e?t:t.toLowerCase(),r=e?o:o.toLowerCase();switch(!0){case n==="/":return o;case r===n:return"";case o.length<t.length:return o;case r[n.length]!=="/":return o;case r.startsWith(n):return o.slice(t.length);default:return o}}function Me(t,o,e){if(t!=="/"&&!o.startsWith(t))return;o=Ct(t,o,e.caseSensitive);const n=Ct(t,`${e.to??"$"}`,e.caseSensitive),r=dt(o),i=dt(n);o.startsWith("/")||r.unshift({type:"pathname",value:"/"}),n.startsWith("/")||i.unshift({type:"pathname",value:"/"});const s={};return(()=>{for(let u=0;u<Math.max(r.length,i.length);u++){const c=r[u],l=i[u],d=u>=r.length-1,h=u>=i.length-1;if(l){if(l.type==="wildcard"){const f=decodeURI(Y(r.slice(u).map(p=>p.value)));return s["*"]=f,s._splat=f,!0}if(l.type==="pathname"){if(l.value==="/"&&!(c!=null&&c.value))return!0;if(c){if(e.caseSensitive){if(l.value!==c.value)return!1}else if(l.value.toLowerCase()!==c.value.toLowerCase())return!1}}if(!c)return!1;if(l.type==="param"){if(c.value==="/")return!1;c.value.charAt(0)!=="$"&&(s[l.value.substring(1)]=decodeURIComponent(c.value))}}if(!d&&h)return s["**"]=Y(r.slice(u+1).map(f=>f.value)),!!e.fuzzy&&(l==null?void 0:l.value)!=="/"}return!0})()?s:void 0}function ot(t){return!!(t!=null&&t.isRedirect)}function Ft(t){return!!(t!=null&&t.isRedirect)&&t.href}function kt(t){const o=t.errorComponent??xt;return y.jsx(Re,{getResetKey:t.getResetKey,onCatch:t.onCatch,children:({error:e,reset:n})=>e?S.createElement(o,{error:e,reset:n}):t.children})}class Re extends S.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(o){return{resetKey:o.getResetKey()}}static getDerivedStateFromError(o){return{error:o}}reset(){this.setState({error:null})}componentDidUpdate(o,e){e.error&&e.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(o,e){this.props.onCatch&&this.props.onCatch(o,e)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function xt({error:t}){const[o,e]=S.useState(!1);return y.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[y.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),y.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>e(n=>!n),children:o?"Hide Error":"Show Error"})]}),y.jsx("div",{style:{height:".25rem"}}),o?y.jsx("div",{children:y.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:t.message?y.jsx("code",{children:t.message}):null})}):null]})}function U(t){const o=et({warn:(t==null?void 0:t.router)===void 0});return fe(((t==null?void 0:t.router)||o).__store,t==null?void 0:t.select)}function Q(t){return!!(t!=null&&t.isNotFound)}function Ee(t){const o=U({select:e=>`not-found-${e.location.pathname}-${e.status}`});return y.jsx(kt,{getResetKey:()=>o,onCatch:(e,n)=>{var r;if(Q(e))(r=t.onCatch)==null||r.call(t,e,n);else throw e},errorComponent:({error:e})=>{var n;if(Q(e))return(n=t.fallback)==null?void 0:n.call(t,e);throw e},children:t.children})}function Ie(){return y.jsx("p",{children:"Not Found"})}const Fe={stringify:t=>JSON.stringify(t,function(e,n){const r=this[e],i=Ht.find(s=>s.stringifyCondition(r));return i?i.stringify(r):n}),parse:t=>JSON.parse(t,function(e,n){const r=this[e],i=Ht.find(s=>s.parseCondition(r));return i?i.parse(r):n})},Ht=[{stringifyCondition:t=>t instanceof Date,stringify:t=>({$date:t.toISOString()}),parseCondition:t=>ut(t)&&t.$date,parse:t=>new Date(t.$date)},{stringifyCondition:t=>t===void 0,stringify:()=>({$undefined:""}),parseCondition:t=>ut(t)&&t.$undefined==="",parse:()=>{}}],Zt=["component","errorComponent","pendingComponent","notFoundComponent"];function Te(t){var o;for(const e of Zt)if((o=t.options[e])!=null&&o.preload)return!0;return!1}function Wt(t,o){if(t==null)return{};if("~validate"in t){const e=t["~validate"]({value:o});if("value"in e)return e.value;throw new te(JSON.stringify(e.issues,void 0,2))}return"parse"in t?t.parse(o):typeof t=="function"?t(o):{}}function on(t){return new je(t)}class je{constructor(o){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.subscribers=new Set,this.startReactTransition=e=>e(),this.update=e=>{e.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/guide/not-found-errors#migrating-from-notfoundroute for more info.");const n=this.options;this.options={...this.options,...e},this.isServer=this.options.isServer??typeof document>"u",(!this.basepath||e.basepath&&e.basepath!==n.basepath)&&(e.basepath===void 0||e.basepath===""||e.basepath==="/"?this.basepath="/":this.basepath=`/${Ce(e.basepath)}`),(!this.history||this.options.history&&this.options.history!==this.history)&&(this.history=this.options.history??(this.isServer?ue({initialEntries:[this.basepath||"/"]}):le()),this.latestLocation=this.parseLocation()),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),this.__store||(this.__store=new he(Oe(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(r=>!["redirected"].includes(r.status))}}}))},this.buildRouteTree=()=>{this.routesById={},this.routesByPath={};const e=this.options.notFoundRoute;e&&(e.init({originalIndex:99999999999,defaultSsr:this.options.defaultSsr}),this.routesById[e.id]=e);const n=s=>{s.forEach((a,u)=>{a.init({originalIndex:u,defaultSsr:this.options.defaultSsr});const c=this.routesById[a.id];if(K(!c,`Duplicate routes found with id: ${String(a.id)}`),this.routesById[a.id]=a,!a.isRoot&&a.path){const d=st(a.fullPath);(!this.routesByPath[d]||a.fullPath.endsWith("/"))&&(this.routesByPath[d]=a)}const l=a.children;l!=null&&l.length&&n(l)})};n([this.routeTree]);const r=[];Object.values(this.routesById).forEach((s,a)=>{var u;if(s.isRoot||!s.path)return;const c=jt(s.fullPath),l=dt(c);for(;l.length>1&&((u=l[0])==null?void 0:u.value)==="/";)l.shift();const d=l.map(h=>h.value==="/"?.75:h.type==="param"?.5:h.type==="wildcard"?.25:1);r.push({child:s,trimmed:c,parsed:l,index:a,scores:d})}),this.flatRoutes=r.sort((s,a)=>{const u=Math.min(s.scores.length,a.scores.length);for(let c=0;c<u;c++)if(s.scores[c]!==a.scores[c])return a.scores[c]-s.scores[c];if(s.scores.length!==a.scores.length)return a.scores.length-s.scores.length;for(let c=0;c<u;c++)if(s.parsed[c].value!==a.parsed[c].value)return s.parsed[c].value>a.parsed[c].value?1:-1;return s.index-a.index}).map((s,a)=>(s.child.rank=a,s.child))},this.subscribe=(e,n)=>{const r={eventType:e,fn:n};return this.subscribers.add(r),()=>{this.subscribers.delete(r)}},this.emit=e=>{this.subscribers.forEach(n=>{n.eventType===e.type&&n.fn(e)})},this.parseLocation=e=>{const n=({pathname:a,search:u,hash:c,state:l})=>{const d=this.options.parseSearch(u),h=this.options.stringifySearch(d);return{pathname:a,searchStr:h,search:it(e==null?void 0:e.search,d),hash:c.split("#").reverse()[0]??"",href:`${a}${h}${c}`,state:it(e==null?void 0:e.state,l)}},r=n(this.history.location),{__tempLocation:i,__tempKey:s}=r.state;if(i&&(!s||s===this.tempLocationKey)){const a=n(i);return a.state.key=r.state.key,delete a.state.__tempLocation,{...a,maskedLocation:r}}return r},this.resolvePathWithBase=(e,n)=>xe({basepath:this.basepath,base:e,to:wt(n),trailingSlash:this.options.trailingSlash,caseSensitive:this.options.caseSensitive}),this.getMatchedRoutes=(e,n)=>{let r={};const i=st(e.pathname),s=l=>Pt(this.basepath,i,{to:l.fullPath,caseSensitive:l.options.caseSensitive??this.options.caseSensitive,fuzzy:!0});let a=(n==null?void 0:n.to)!==void 0?this.routesByPath[n.to]:void 0;a?r=s(a):a=this.flatRoutes.find(l=>{const d=s(l);return d?(r=d,!0):!1});let u=a||this.routesById[G];const c=[u];for(;u.parentRoute;)u=u.parentRoute,c.unshift(u);return{matchedRoutes:c,routeParams:r,foundRoute:a}},this.cancelMatch=e=>{const n=this.getMatch(e);n&&(n.abortController.abort(),clearTimeout(n.pendingTimeout))},this.cancelMatches=()=>{var e;(e=this.state.pendingMatches)==null||e.forEach(n=>{this.cancelMatch(n.id)})},this.buildLocation=e=>{const n=(i={},s)=>{var a,u,c,l,d,h;const f=i._fromLocation?this.matchRoutes(i._fromLocation,{_buildLocation:!0}):this.state.matches,p=i.from!=null?f.find(_=>Pt(this.basepath,st(_.pathname),{to:i.from,caseSensitive:!1,fuzzy:!1})):void 0,g=(p==null?void 0:p.pathname)||this.latestLocation.pathname;K(i.from==null||p!=null,"Could not find match for from: "+i.from);const m=(a=this.state.pendingMatches)!=null&&a.length?(u=mt(this.state.pendingMatches))==null?void 0:u.search:((c=mt(f))==null?void 0:c.search)||this.latestLocation.search,x=s==null?void 0:s.matchedRoutes.filter(_=>f.find(E=>E.routeId===_.id));let L;if(i.to)L=this.resolvePathWithBase(g,`${i.to}`);else{const _=this.routesById[(l=x==null?void 0:x.find(E=>{const z=_t({path:E.fullPath,params:(s==null?void 0:s.routeParams)??{}});return Y([this.basepath,z])===g}))==null?void 0:l.id];L=this.resolvePathWithBase(g,(_==null?void 0:_.to)??g)}const v={...(d=mt(f))==null?void 0:d.params};let C=(i.params??!0)===!0?v:{...v,...ct(i.params,v)};Object.keys(C).length>0&&(s==null||s.matchedRoutes.map(_=>{var E;return((E=_.options.params)==null?void 0:E.stringify)??_.options.stringifyParams}).filter(Boolean).forEach(_=>{C={...C,..._(C)}})),L=_t({path:L,params:C??{},leaveWildcards:!1,leaveParams:e.leaveParams});let j=m;if(e._includeValidateSearch){let _=(h=this.options.search)!=null&&h.strict?{}:j;s==null||s.matchedRoutes.forEach(E=>{try{E.options.validateSearch&&(_={..._,...Wt(E.options.validateSearch,{..._,...j})??{}})}catch{}}),j=_}j=(_=>{const E=(s==null?void 0:s.matchedRoutes.reduce((O,F)=>{var b;let H=[];return"search"in F.options?(b=F.options.search)!=null&&b.middlewares&&(H=F.options.search.middlewares):(F.options.preSearchFilters||F.options.postSearchFilters)&&(H=[({search:I,next:w})=>{let M=I;"preSearchFilters"in F.options&&F.options.preSearchFilters&&(M=F.options.preSearchFilters.reduce((X,D)=>D(X),I));const J=w(M);return"postSearchFilters"in F.options&&F.options.postSearchFilters?F.options.postSearchFilters.reduce((X,D)=>D(X),J):J}]),O.concat(H)},[]))??[],z=({search:O})=>i.search?i.search===!0?O:ct(i.search,O):{};E.push(z);const V=(O,F)=>{if(O>=E.length)return F;const b=E[O];return b({search:F,next:W=>V(O+1,W)})};return V(0,_)})(j),j=it(m,j);const k=this.options.stringifySearch(j),R=i.hash===!0?this.latestLocation.hash:i.hash?ct(i.hash,this.latestLocation.hash):void 0,P=R?`#${R}`:"";let N=i.state===!0?this.latestLocation.state:i.state?ct(i.state,this.latestLocation.state):{};return N=it(this.latestLocation.state,N),{pathname:L,search:j,searchStr:k,state:N,hash:R??"",href:`${L}${k}${P}`,unmaskOnReload:i.unmaskOnReload}},r=(i={},s)=>{var a;const u=n(i);let c=s?n(s):void 0;if(!c){let h={};const f=(a=this.options.routeMasks)==null?void 0:a.find(p=>{const g=Pt(this.basepath,u.pathname,{to:p.from,caseSensitive:!1,fuzzy:!1});return g?(h=g,!0):!1});if(f){const{from:p,...g}=f;s={...vt(e,["from"]),...g,params:h},c=n(s)}}const l=this.getMatchedRoutes(u,i),d=n(i,l);if(c){const h=this.getMatchedRoutes(c,s),f=n(s,h);d.maskedLocation=f}return d};return e.mask?r(e,{...vt(e,["from"]),...e.mask}):r(e)},this.commitLocation=({viewTransition:e,ignoreBlocker:n,...r})=>{const i=()=>{r.state.key=this.latestLocation.state.key;const u=lt(r.state,this.latestLocation.state);return delete r.state.key,u},s=this.latestLocation.href===r.href,a=this.commitLocationPromise;if(this.commitLocationPromise=at(()=>{a==null||a.resolve()}),s&&i())this.load();else{let{maskedLocation:u,...c}=r;u&&(c={...u,state:{...u.state,__tempKey:void 0,__tempLocation:{...c,search:c.searchStr,state:{...c.state,__tempKey:void 0,__tempLocation:void 0,key:void 0}}}},(c.unmaskOnReload??this.options.unmaskOnReload??!1)&&(c.state.__tempKey=this.tempLocationKey)),this.shouldViewTransition=e,this.history[r.replace?"replace":"push"](c.href,c.state,{ignoreBlocker:n})}return this.resetNextScroll=r.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:e,resetScroll:n,viewTransition:r,ignoreBlocker:i,...s}={})=>{const a=s.href;if(a){const c=bt(a,{});s.to=c.pathname,s.search=this.options.parseSearch(c.search),s.hash=c.hash.slice(1)}const u=this.buildLocation({...s,_includeValidateSearch:!0});return this.commitLocation({...u,viewTransition:r,replace:e,resetScroll:n,ignoreBlocker:i})},this.navigate=({to:e,...n})=>{const r=String(e);let i;try{new URL(`${r}`),i=!0}catch{}return K(!i),this.buildAndCommitLocation({...n,to:e})},this.load=async()=>{this.latestLocation=this.parseLocation(this.latestLocation);let e,n,r;for(r=new Promise(i=>{this.startReactTransition(async()=>{var s;try{const a=this.latestLocation,u=this.state.resolvedLocation,c=u.href!==a.href;this.cancelMatches();let l;this.__store.batch(()=>{l=this.matchRoutes(a),this.__store.setState(d=>({...d,status:"pending",isLoading:!0,location:a,pendingMatches:l,cachedMatches:d.cachedMatches.filter(h=>!l.find(f=>f.id===h.id))}))}),this.state.redirect||this.emit({type:"onBeforeNavigate",fromLocation:u,toLocation:a,pathChanged:c}),this.emit({type:"onBeforeLoad",fromLocation:u,toLocation:a,pathChanged:c}),await this.loadMatches({matches:l,location:a,onReady:async()=>{this.startViewTransition(async()=>{let d,h,f;this.__store.batch(()=>{this.__store.setState(p=>{const g=p.matches,m=p.pendingMatches||p.matches;return d=g.filter(x=>!m.find(L=>L.id===x.id)),h=m.filter(x=>!g.find(L=>L.id===x.id)),f=g.filter(x=>m.find(L=>L.id===x.id)),{...p,isLoading:!1,loadedAt:Date.now(),matches:m,pendingMatches:void 0,cachedMatches:[...p.cachedMatches,...d.filter(x=>x.status!=="error")]}}),this.clearExpiredCache()}),[[d,"onLeave"],[h,"onEnter"],[f,"onStay"]].forEach(([p,g])=>{p.forEach(m=>{var x,L;(L=(x=this.looseRoutesById[m.routeId].options)[g])==null||L.call(x,m)})})})}})}catch(a){Ft(a)?(e=a,this.isServer||this.navigate({...a,replace:!0,ignoreBlocker:!0})):Q(a)&&(n=a),this.__store.setState(u=>({...u,statusCode:e?e.statusCode:n?404:u.matches.some(c=>c.status==="error")?500:200,redirect:e}))}this.latestLoadPromise===r&&((s=this.commitLocationPromise)==null||s.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),i()})}),this.latestLoadPromise=r,await r;this.latestLoadPromise&&r!==this.latestLoadPromise;)await this.latestLoadPromise},this.startViewTransition=e=>{const n=this.shouldViewTransition??this.options.defaultViewTransition;delete this.shouldViewTransition,n&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"?document.startViewTransition(e):e()},this.updateMatch=(e,n)=>{var r;let i;const s=(r=this.state.pendingMatches)==null?void 0:r.find(c=>c.id===e),a=this.state.matches.find(c=>c.id===e),u=s?"pendingMatches":a?"matches":"cachedMatches";return this.__store.setState(c=>{var l;return{...c,[u]:(l=c[u])==null?void 0:l.map(d=>d.id===e?i=n(d):d)}}),i},this.getMatch=e=>[...this.state.cachedMatches,...this.state.pendingMatches??[],...this.state.matches].find(n=>n.id===e),this.loadMatches=async({location:e,matches:n,preload:r,onReady:i,updateMatch:s=this.updateMatch})=>{let a,u=!1;const c=async()=>{u||(u=!0,await(i==null?void 0:i()))};!this.isServer&&!this.state.matches.length&&c();const l=(d,h)=>{var f,p,g;if(Ft(h))throw h;if(ot(h)||Q(h)){if(s(d.id,m=>({...m,status:ot(h)?"redirected":Q(h)?"notFound":"error",isFetching:!1,error:h,beforeLoadPromise:void 0,loaderPromise:void 0})),h.routeId||(h.routeId=d.routeId),(f=d.beforeLoadPromise)==null||f.resolve(),(p=d.loaderPromise)==null||p.resolve(),(g=d.loadPromise)==null||g.resolve(),ot(h))throw u=!0,h=this.resolveRedirect({...h,_fromLocation:e}),h;if(Q(h))throw this._handleNotFound(n,h,{updateMatch:s}),h}};try{await new Promise((d,h)=>{(async()=>{var f,p,g;try{const m=(v,C,j)=>{var A,k;const{id:R,routeId:P}=n[v],N=this.looseRoutesById[P];if(C instanceof Promise)throw C;C.routerCode=j,a=a??v,l(this.getMatch(R),C);try{(k=(A=N.options).onError)==null||k.call(A,C)}catch(_){C=_,l(this.getMatch(R),C)}s(R,_=>{var E,z;return(E=_.beforeLoadPromise)==null||E.resolve(),(z=_.loadPromise)==null||z.resolve(),{..._,error:C,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController,beforeLoadPromise:void 0}})};for(const[v,{id:C,routeId:j}]of n.entries()){const A=this.getMatch(C),k=(f=n[v-1])==null?void 0:f.id,R=this.looseRoutesById[j],P=R.options.pendingMs??this.options.defaultPendingMs,N=!!(i&&!this.isServer&&!r&&(R.options.loader||R.options.beforeLoad)&&typeof P=="number"&&P!==1/0&&(R.options.pendingComponent??this.options.defaultPendingComponent));if(A.beforeLoadPromise||A.loaderPromise)N&&setTimeout(()=>{try{c()}catch{}},P),await A.beforeLoadPromise;else{try{s(C,M=>({...M,loadPromise:at(()=>{var J;(J=M.loadPromise)==null||J.resolve()}),beforeLoadPromise:at()}));const _=new AbortController;let E;N&&(E=setTimeout(()=>{try{c()}catch{}},P));const{paramsError:z,searchError:V}=this.getMatch(C);z&&m(v,z,"PARSE_PARAMS"),V&&m(v,V,"VALIDATE_SEARCH");const O=()=>k?this.getMatch(k).context:this.options.context??{};s(C,M=>({...M,isFetching:"beforeLoad",fetchCount:M.fetchCount+1,abortController:_,pendingTimeout:E,context:{...O(),...M.__routeContext,...M.__beforeLoadContext}}));const{search:F,params:b,context:H,cause:W}=this.getMatch(C),I={search:F,abortController:_,params:b,preload:!!r,context:H,location:e,navigate:M=>this.navigate({...M,_fromLocation:e}),buildLocation:this.buildLocation,cause:r?"preload":W,matches:n};let w=await((g=(p=R.options).beforeLoad)==null?void 0:g.call(p,I))??{};this.serializeLoaderData&&(w=this.serializeLoaderData("__beforeLoadContext",w,{router:this,match:this.getMatch(C)})),(ot(w)||Q(w))&&m(v,w,"BEFORE_LOAD"),s(C,M=>({...M,__beforeLoadContext:w,context:{...O(),...M.__routeContext,...w},abortController:_}))}catch(_){m(v,_,"BEFORE_LOAD")}s(C,_=>{var E;return(E=_.beforeLoadPromise)==null||E.resolve(),{..._,beforeLoadPromise:void 0,isFetching:!1}})}}const x=n.slice(0,a),L=[];x.forEach(({id:v,routeId:C},j)=>{L.push((async()=>{const{loaderPromise:A}=this.getMatch(v);let k=!1;if(A)await A;else{const R=L[j-1],P=this.looseRoutesById[C],N=()=>{const{params:I,loaderDeps:w,abortController:M,context:J,cause:X}=this.getMatch(v);return{params:I,deps:w,preload:!!r,parentMatchPromise:R,abortController:M,context:J,location:e,navigate:D=>this.navigate({...D,_fromLocation:e}),cause:r?"preload":X,route:P}},_=Date.now()-this.getMatch(v).updatedAt,E=r?P.options.preloadStaleTime??this.options.defaultPreloadStaleTime??3e4:P.options.staleTime??this.options.defaultStaleTime??0,z=P.options.shouldReload,V=typeof z=="function"?z(N()):z;s(v,I=>({...I,loaderPromise:at(),preload:!!r&&!this.state.matches.find(w=>w.id===v)}));const O=async()=>{var I,w,M,J,X,D,gt,yt;try{const nt=async()=>{const $=this.getMatch(v);$.minPendingPromise&&await $.minPendingPromise};try{P._lazyPromise===void 0&&(P.lazyFn?P._lazyPromise=P.lazyFn().then(q=>{const{id:tt,...ft}=q.options;Object.assign(P.options,ft)}):P._lazyPromise=Promise.resolve()),P._componentsPromise===void 0&&(P._componentsPromise=P._lazyPromise.then(()=>Promise.all(Zt.map(async q=>{const tt=P.options[q];tt!=null&&tt.preload&&await tt.preload()})))),s(v,q=>({...q,isFetching:"loader"}));let $=await((w=(I=P.options).loader)==null?void 0:w.call(I,N()));this.serializeLoaderData&&($=this.serializeLoaderData("loaderData",$,{router:this,match:this.getMatch(v)})),l(this.getMatch(v),$),await P._lazyPromise,await nt();const rt=(J=(M=P.options).meta)==null?void 0:J.call(M,{matches:n,match:this.getMatch(v),params:this.getMatch(v).params,loaderData:$}),Z=(D=(X=P.options).headers)==null?void 0:D.call(X,{loaderData:$});s(v,q=>({...q,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),loaderData:$,meta:rt,headers:Z}))}catch($){let rt=$;await nt(),l(this.getMatch(v),$);try{(yt=(gt=P.options).onError)==null||yt.call(gt,$)}catch(Z){rt=Z,l(this.getMatch(v),Z)}s(v,Z=>({...Z,error:rt,status:"error",isFetching:!1}))}await P._componentsPromise}catch(nt){l(this.getMatch(v),nt)}},{status:F,invalid:b}=this.getMatch(v);k=F==="success"&&(b||(V??_>E)),r&&P.options.preload===!1||(k?(async()=>{try{await O()}catch(I){Ft(I)&&await this.navigate(I)}})():F!=="success"&&await O());const{loaderPromise:H,loadPromise:W}=this.getMatch(v);H==null||H.resolve(),W==null||W.resolve()}return s(v,R=>({...R,isFetching:k?R.isFetching:!1,loaderPromise:void 0,invalid:!1})),this.getMatch(v)})())}),await Promise.all(L),d()}catch(m){h(m)}})()}),await c()}catch(d){if(ot(d)||Q(d))throw Q(d)&&!r&&await c(),d}return n},this.invalidate=e=>{const n=r=>{var i;return((i=e==null?void 0:e.filter)==null?void 0:i.call(e,r))??!0?{...r,invalid:!0,...r.status==="error"?{status:"pending",error:void 0}:{}}:r};return this.__store.setState(r=>{var i;return{...r,matches:r.matches.map(n),cachedMatches:r.cachedMatches.map(n),pendingMatches:(i=r.pendingMatches)==null?void 0:i.map(n)}}),this.load()},this.resolveRedirect=e=>{const n=e;return n.href||(n.href=this.buildLocation(n).href),n},this.clearCache=e=>{const n=e==null?void 0:e.filter;n!==void 0?this.__store.setState(r=>({...r,cachedMatches:r.cachedMatches.filter(i=>!n(i))})):this.__store.setState(r=>({...r,cachedMatches:[]}))},this.clearExpiredCache=()=>{const e=n=>{const r=this.looseRoutesById[n.routeId];if(!r.options.loader)return!0;const i=(n.preload?r.options.preloadGcTime??this.options.defaultPreloadGcTime:r.options.gcTime??this.options.defaultGcTime)??5*60*1e3;return!(n.status!=="error"&&Date.now()-n.updatedAt<i)};this.clearCache({filter:e})},this.preloadRoute=async e=>{const n=this.buildLocation(e);let r=this.matchRoutes(n,{throwOnError:!0,preload:!0,dest:e});const i=Object.fromEntries([...this.state.matches,...this.state.pendingMatches??[],...this.state.cachedMatches].map(a=>[a.id,!0]));this.__store.batch(()=>{r.forEach(a=>{i[a.id]||this.__store.setState(u=>({...u,cachedMatches:[...u.cachedMatches,a]}))})});const s=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(a=>a.id));try{return r=await this.loadMatches({matches:r,location:n,preload:!0,updateMatch:(a,u)=>{s.has(a)?r=r.map(c=>c.id===a?u(c):c):this.updateMatch(a,u)}}),r}catch(a){if(ot(a))return await this.preloadRoute({...a,_fromLocation:n});console.error(a);return}},this.matchRoute=(e,n)=>{const r={...e,to:e.to?this.resolvePathWithBase(e.from||"",e.to):void 0,params:e.params||{},leaveParams:!0},i=this.buildLocation(r);if(n!=null&&n.pending&&this.state.status!=="pending")return!1;const a=((n==null?void 0:n.pending)===void 0?!this.state.isLoading:n.pending)?this.latestLocation:this.state.resolvedLocation,u=Pt(this.basepath,a.pathname,{...n,to:i.pathname});return!u||e.params&&!lt(u,e.params,{partial:!0})?!1:u&&((n==null?void 0:n.includeSearch)??!0)?lt(a.search,i.search,{partial:!0})?u:!1:u},this.dehydrate=()=>{var e;const n=((e=this.options.errorSerializer)==null?void 0:e.serialize)??Be;return{state:{dehydratedMatches:this.state.matches.map(r=>({...vt(r,["id","status","updatedAt"]),error:r.error?{data:n(r.error),__isServerError:!0}:void 0}))},manifest:this.manifest}},this.hydrate=()=>{var e,n,r;let i;typeof document<"u"&&(i=this.options.transformer.parse((e=window.__TSR__)==null?void 0:e.dehydrated)),K(i),this.dehydratedData=i.payload,(r=(n=this.options).hydrate)==null||r.call(n,i.payload);const s=i.router.state,a=this.matchRoutes(this.state.location).map(u=>{const c=s.dehydratedMatches.find(l=>l.id===u.id);return K(c,`Could not find a client-side match for dehydrated match with id: ${u.id}!`),{...u,...c}});this.__store.setState(u=>({...u,matches:a})),this.manifest=i.router.manifest},this.injectedHtml=[],this.injectHtml=e=>{const n=()=>(this.injectedHtml=this.injectedHtml.filter(r=>r!==n),e);this.injectedHtml.push(n)},this.streamedKeys=new Set,this.getStreamedValue=e=>{var n;if(this.isServer)return;const r=(n=window.__TSR__)==null?void 0:n.streamedValues[e];if(r)return r.parsed||(r.parsed=this.options.transformer.parse(r.value)),r.parsed},this.streamValue=(e,n)=>{var r;Tt(!this.streamedKeys.has(e)),this.streamedKeys.add(e);const i=`__TSR__.streamedValues['${e}'] = { value: ${(r=this.serializer)==null?void 0:r.call(this,this.options.transformer.stringify(n))}}`;this.injectHtml(`<script class='tsr-once'>${i}; __TSR__.cleanScripts()<\/script>`)},this._handleNotFound=(e,n,{updateMatch:r=this.updateMatch}={})=>{const i=Object.fromEntries(e.map(u=>[u.routeId,u]));let s=(n.global?this.looseRoutesById[G]:this.looseRoutesById[n.routeId])||this.looseRoutesById[G];for(;!s.options.notFoundComponent&&!this.options.defaultNotFoundComponent&&s.id!==G;)s=s.parentRoute,K(s);const a=i[s.id];K(a,"Could not find match for route: "+s.id),r(a.id,u=>({...u,status:"notFound",error:n,isFetching:!1})),n.routerCode==="BEFORE_LOAD"&&s.parentRoute&&(n.routeId=s.parentRoute.id,this._handleNotFound(e,n,{updateMatch:r}))},this.hasNotFoundMatch=()=>this.__store.state.matches.some(e=>e.status==="notFound"||e.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...o,caseSensitive:o.caseSensitive??!1,notFoundMode:o.notFoundMode??"fuzzy",stringifySearch:o.stringifySearch??ye,parseSearch:o.parseSearch??ge,transformer:o.transformer??Fe}),typeof document<"u"&&(window.__TSR__ROUTER__=this)}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutes(o,e,n){return typeof o=="string"?this.matchRoutesInternal({pathname:o,search:e},n):this.matchRoutesInternal(o,e)}matchRoutesInternal(o,e){const{foundRoute:n,matchedRoutes:r,routeParams:i}=this.getMatchedRoutes(o,e==null?void 0:e.dest);let s=!1;(n?n.path!=="/"&&i["**"]:st(o.pathname))&&(this.options.notFoundRoute?r.push(this.options.notFoundRoute):s=!0);const a=(()=>{if(s){if(this.options.notFoundMode!=="root")for(let l=r.length-1;l>=0;l--){const d=r[l];if(d.children)return d.id}return G}})(),u=r.map(l=>{var d;let h;const f=((d=l.options.params)==null?void 0:d.parse)??l.options.parseParams;if(f)try{const p=f(i);Object.assign(i,p)}catch(p){if(h=new ke(p.message,{cause:p}),e!=null&&e.throwOnError)throw h;return h}}),c=[];return r.forEach((l,d)=>{var h,f,p,g,m,x,L,v,C,j,A,k;const R=c[d-1],[P,N]=(()=>{const I=(R==null?void 0:R.search)??o.search;try{const w=Wt(l.options.validateSearch,I)??{};return[{...I,...w},void 0]}catch(w){const M=new te(w.message,{cause:w});if(e!=null&&e.throwOnError)throw M;return[I,M]}})(),_=((f=(h=l.options).loaderDeps)==null?void 0:f.call(h,{search:P}))??"",E=_?JSON.stringify(_):"",z=_t({path:l.fullPath,params:i}),V=_t({path:l.id,params:i,leaveWildcards:!0})+E,O=this.getMatch(V),F=this.state.matches.find(I=>I.id===V)?"stay":"enter";let b;if(O)b={...O,cause:F,params:i};else{const I=l.options.loader||l.options.beforeLoad||l.lazyFn||Te(l)?"pending":"success";b={id:V,index:d,routeId:l.id,params:i,pathname:Y([this.basepath,z]),updatedAt:Date.now(),search:{},searchError:void 0,status:I,isFetching:!1,error:void 0,paramsError:u[d],__routeContext:{},__beforeLoadContext:{},context:{},abortController:new AbortController,fetchCount:0,cause:F,loaderDeps:_,invalid:!1,preload:!1,links:(g=(p=l.options).links)==null?void 0:g.call(p),scripts:(x=(m=l.options).scripts)==null?void 0:x.call(m),staticData:l.options.staticData||{},loadPromise:at(),fullPath:l.fullPath}}b.status==="success"&&(b.meta=(v=(L=l.options).meta)==null?void 0:v.call(L,{matches:c,match:b,params:b.params,loaderData:b.loaderData}),b.headers=(j=(C=l.options).headers)==null?void 0:j.call(C,{loaderData:b.loaderData})),e!=null&&e.preload||(b.globalNotFound=a===l.id),b.search=it(b.search,P),b.searchError=N;const W=(R==null?void 0:R.id)?R.context??this.options.context??{}:this.options.context??{};if(b.context={...W,...b.__routeContext,...b.__beforeLoadContext},!O&&(e==null?void 0:e._buildLocation)!==!0){const I={deps:_,params:b.params,context:b.context,location:o,navigate:w=>this.navigate({...w,_fromLocation:o}),buildLocation:this.buildLocation,cause:b.cause,abortController:b.abortController,preload:!!b.preload,matches:c};b.__routeContext=((k=(A=l.options).context)==null?void 0:k.call(A,I))??{},b.context={...W,...b.__routeContext,...b.__beforeLoadContext}}c.push(b)}),c}}class te extends Error{}class ke extends Error{}function Oe(t){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:{...t},location:t,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function Be(t){return t instanceof Error?{name:t.name,message:t.message}:{data:t}}function qt(t){return!(typeof t=="object"&&t&&"data"in t)||!("__isServerError"in t&&t.__isServerError)||!(typeof t.data=="object"&&t.data)?!1:t.__isServerError===!0}function Gt(t){if("name"in t&&"message"in t){const o=new Error(t.message);return o.name=t.name,o}return t.data}const Mt=S.createContext(void 0);function ht(t){const o=S.useContext(Mt);return U({select:n=>{const r=n.matches.find(i=>t.from?t.from===i.routeId:i.id===o);if(K(!((t.shouldThrow??!0)&&!r),`Could not find ${t.from?`an active match from "${t.from}"`:"a nearest match!"}`),r!==void 0)return t.select?t.select(r):r}})}function Ae(t){return ht({...t,select:o=>typeof t.select=="function"?t.select(o.loaderDeps):o.loaderDeps})}function Ne(t){return ht({...t,select:o=>typeof t.select=="function"?t.select(o.loaderData):o.loaderData})}function ze(t){return ht({...t,select:o=>t.select?t.select(o.params):o.params})}function De(t){return ht({...t,select:o=>t.select?t.select(o.search):o.search})}function $e(t){const{navigate:o}=et();return S.useCallback(e=>o({...e}),[o])}class ee{constructor(o){this.init=e=>{var n,r;this.originalIndex=e.originalIndex;const i=this.options,s=!(i!=null&&i.path)&&!(i!=null&&i.id);this.parentRoute=(r=(n=this.options).getParentRoute)==null?void 0:r.call(n),s?this._path=G:K(this.parentRoute);let a=s?G:i.path;a&&a!=="/"&&(a=jt(a));const u=(i==null?void 0:i.id)||a;let c=s?G:Y([this.parentRoute.id===G?"":this.parentRoute.id,u]);a===G&&(a="/"),c!==G&&(c=Y(["/",c]));const l=c===G?"/":Y([this.parentRoute.fullPath,a]);this._path=a,this._id=c,this._fullPath=l,this._to=l,this._ssr=(i==null?void 0:i.ssr)??e.defaultSsr??!0},this.updateLoader=e=>(Object.assign(this.options,e),this),this.update=e=>(Object.assign(this.options,e),this),this.lazy=e=>(this.lazyFn=e,this),this.useMatch=e=>ht({...e,from:this.id}),this.useRouteContext=e=>ht({...e,from:this.id,select:n=>e!=null&&e.select?e.select(n.context):n.context}),this.useSearch=e=>De({...e,from:this.id}),this.useParams=e=>ze({...e,from:this.id}),this.useLoaderDeps=e=>Ae({...e,from:this.id}),this.useLoaderData=e=>Ne({...e,from:this.id}),this.useNavigate=()=>$e({from:this.id}),this.options=o||{},this.isRoot=!(o!=null&&o.getParentRoute),K(!(o!=null&&o.id&&(o!=null&&o.path))),this.$$typeof=Symbol.for("react.memo")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}get ssr(){return this._ssr}addChildren(o){return this._addFileChildren(o)}_addFileChildren(o){return Array.isArray(o)&&(this.children=o),typeof o=="object"&&o!==null&&(this.children=Object.values(o)),this}}function sn(t){return new ee(t)}class Ke extends ee{constructor(o){super(o)}addChildren(o){return super.addChildren(o),this}_addFileChildren(o){return super._addFileChildren(o),this}_addFileTypes(){return this}}function rn(t){return new Ke(t)}function St(t){return y.jsx(y.Fragment,{children:t.children})}function ne(t,o,e){return o.options.notFoundComponent?y.jsx(o.options.notFoundComponent,{data:e}):t.options.defaultNotFoundComponent?y.jsx(t.options.defaultNotFoundComponent,{data:e}):y.jsx(Ie,{})}const oe=S.memo(function({matchId:o}){var e,n;const r=et(),i=U({select:m=>{var x;return(x=m.matches.find(L=>L.id===o))==null?void 0:x.routeId}});K(i);const s=r.routesById[i],a=s.options.pendingComponent??r.options.defaultPendingComponent,u=a?y.jsx(a,{}):null,c=s.options.errorComponent??r.options.defaultErrorComponent,l=s.options.onCatch??r.options.defaultOnCatch,d=s.isRoot?s.options.notFoundComponent??((e=r.options.notFoundRoute)==null?void 0:e.options.component):s.options.notFoundComponent,h=(!s.isRoot||s.options.wrapInSuspense)&&(s.options.wrapInSuspense??a??((n=s.options.errorComponent)==null?void 0:n.preload))?S.Suspense:St,f=c?kt:St,p=d?Ee:St,g=U({select:m=>m.loadedAt});return y.jsx(Mt.Provider,{value:o,children:y.jsx(h,{fallback:u,children:y.jsx(f,{getResetKey:()=>g,errorComponent:c||xt,onCatch:(m,x)=>{if(Q(m))throw m;l==null||l(m,x)},children:y.jsx(p,{fallback:m=>{if(!d||m.routeId&&m.routeId!==i||!m.routeId&&!s.isRoot)throw m;return S.createElement(d,m)},children:y.jsx(Ue,{matchId:o})})})})})}),Ue=S.memo(function({matchId:o}){var e,n,r;const i=et(),{match:s,matchIndex:a,routeId:u}=U({select:h=>{const f=h.matches.findIndex(m=>m.id===o),p=h.matches[f];return{routeId:p.routeId,matchIndex:f,match:vt(p,["id","status","error","loadPromise"])}}}),c=i.routesById[u],l=S.useMemo(()=>{const h=c.options.component??i.options.defaultComponent;return h?y.jsx(h,{}):y.jsx(Ve,{})},[c.options.component,i.options.defaultComponent]),d=(c.options.errorComponent??i.options.defaultErrorComponent)||xt;if(s.status==="notFound"){let h;return qt(s.error)?h=(((e=i.options.errorSerializer)==null?void 0:e.deserialize)??Gt)(s.error.data):h=s.error,K(Q(h)),ne(i,c,h)}if(s.status==="redirected")throw K(ot(s.error)),s.loadPromise;if(s.status==="error"){if(i.isServer)return y.jsx(d,{error:s.error,info:{componentStack:""}});throw qt(s.error)?(((n=i.options.errorSerializer)==null?void 0:n.deserialize)??Gt)(s.error.data):s.error}if(s.status==="pending"){const h=c.options.pendingMinMs??i.options.defaultPendingMinMs;if(h&&!((r=i.getMatch(s.id))!=null&&r.minPendingPromise)&&!i.isServer){const f=at();Promise.resolve().then(()=>{i.updateMatch(s.id,p=>({...p,minPendingPromise:f}))}),setTimeout(()=>{f.resolve(),i.updateMatch(s.id,p=>({...p,minPendingPromise:void 0}))},h)}throw s.loadPromise}return y.jsxs(y.Fragment,{children:[l,i.AfterEachMatch?y.jsx(i.AfterEachMatch,{match:s,matchIndex:a}):null]})}),Ve=S.memo(function(){const o=et(),e=S.useContext(Mt),n=U({select:c=>{var l;return(l=c.matches.find(d=>d.id===e))==null?void 0:l.routeId}}),r=o.routesById[n],{parentGlobalNotFound:i}=U({select:c=>{const d=c.matches.find(h=>h.id===e);return K(d),{parentGlobalNotFound:d.globalNotFound}}}),s=U({select:c=>{var l;const d=c.matches,h=d.findIndex(f=>f.id===e);return(l=d[h+1])==null?void 0:l.id}});if(i)return ne(o,r,void 0);if(!s)return null;const a=y.jsx(oe,{matchId:s}),u=o.options.defaultPendingComponent?y.jsx(o.options.defaultPendingComponent,{}):null;return e===G?y.jsx(S.Suspense,{fallback:u,children:a}):a}),He="Error preloading route! ☝️";function We(t,o){const e=et(),[n,r]=S.useState(!1),i=S.useRef(!1),s=Le(o),{activeProps:a=()=>({className:"active"}),inactiveProps:u=()=>({}),activeOptions:c,to:l,preload:d,preloadDelay:h,replace:f,startTransition:p,resetScroll:g,viewTransition:m,children:x,target:L,disabled:v,style:C,className:j,onClick:A,onFocus:k,onMouseEnter:R,onMouseLeave:P,onTouchStart:N,ignoreBlocker:_,...E}=t,{params:z,search:V,hash:O,state:F,mask:b,...H}=E,W=S.useMemo(()=>{try{return new URL(`${l}`),"external"}catch{}return"internal"},[l]),I=U({select:T=>T.location.search}),w=S.useMemo(()=>e.buildLocation(t),[e,t,I]),M=S.useMemo(()=>d??e.options.defaultPreload,[e.options.defaultPreload,d]),J=h??e.options.defaultPreloadDelay??0,X=U({select:T=>{if(c!=null&&c.exact){if(!we(T.location.pathname,w.pathname,e.basepath))return!1}else{const B=Lt(T.location.pathname,e.basepath).split("/");if(!Lt(w.pathname,e.basepath).split("/").every((se,re)=>se===B[re]))return!1}return((c==null?void 0:c.includeSearch)??!0)&&!lt(T.location.search,w.search,{partial:!(c!=null&&c.exact),ignoreUndefined:!(c!=null&&c.explicitUndefined)})?!1:c!=null&&c.includeHash?T.location.hash===w.hash:!0}}),D=S.useCallback(()=>{e.preloadRoute(t).catch(T=>{console.warn(T),console.warn(He)})},[t,e]),gt=S.useCallback(T=>{T!=null&&T.isIntersecting&&D()},[D]);if(be(s,gt,{rootMargin:"100px"},{disabled:!!v||M!=="viewport"}),pt(()=>{i.current||!v&&M==="render"&&(D(),i.current=!0)},[v,D,M]),W==="external")return{...H,ref:s,type:W,href:l,...x&&{children:x},...L&&{target:L},...v&&{disabled:v},...C&&{style:C},...j&&{className:j},...A&&{onClick:A},...k&&{onFocus:k},...R&&{onMouseEnter:R},...P&&{onMouseLeave:P},...N&&{onTouchStart:N}};const yt=T=>{if(!v&&!qe(T)&&!T.defaultPrevented&&(!L||L==="_self")&&T.button===0){T.preventDefault(),ie.flushSync(()=>{r(!0)});const B=e.subscribe("onResolved",()=>{B(),r(!1)});e.buildAndCommitLocation({...t,replace:f,resetScroll:g,startTransition:p,viewTransition:m,ignoreBlocker:_})}},nt=T=>{v||M&&D()},$=nt,rt=T=>{if(v)return;const B=T.target||{};if(M){if(B.preloadTimeout)return;B.preloadTimeout=setTimeout(()=>{B.preloadTimeout=null,D()},J)}},Z=T=>{if(v)return;const B=T.target||{};B.preloadTimeout&&(clearTimeout(B.preloadTimeout),B.preloadTimeout=null)},q=T=>B=>{var Rt;(Rt=B.persist)==null||Rt.call(B),T.filter(Boolean).forEach(At=>{B.defaultPrevented||At(B)})},tt=X?ct(a,{})??{}:{},ft=X?{}:ct(u,{}),Ot=[j,tt.className,ft.className].filter(Boolean).join(" "),Bt={...C,...tt.style,...ft.style};return{...H,...tt,...ft,href:v?void 0:w.maskedLocation?e.history.createHref(w.maskedLocation.href):e.history.createHref(w.href),ref:s,onClick:q([A,yt]),onFocus:q([k,nt]),onMouseEnter:q([R,rt]),onMouseLeave:q([P,Z]),onTouchStart:q([N,$]),disabled:!!v,target:L,...Object.keys(Bt).length&&{style:Bt},...Ot&&{className:Ot},...v&&{role:"link","aria-disabled":!0},...X&&{"data-status":"active","aria-current":"page"},...n&&{"data-transitioning":"transitioning"}}}const an=S.forwardRef((t,o)=>{const{_asChild:e,...n}=t,{type:r,ref:i,...s}=We(n,o),a=typeof n.children=="function"?n.children({isActive:s["data-status"]==="active"}):n.children;return typeof e>"u"&&delete s.disabled,S.createElement(e||"a",{...s,ref:i},a)});function qe(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Ge(){const t=et(),o=S.useRef({router:t,mounted:!1}),e=U({select:d=>vt(d,["isLoading","location","resolvedLocation","isTransitioning"])}),[n,r]=S.useTransition(),i=U({select:d=>d.matches.some(h=>h.status==="pending")}),s=It(e.isLoading),a=e.isLoading||n||i,u=It(a),c=e.isLoading||i,l=It(c);return t.isServer||(t.startReactTransition=r),S.useEffect(()=>{const d=t.history.subscribe(t.load),h=t.buildLocation({to:t.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return st(t.latestLocation.href)!==st(h.href)&&t.commitLocation({...h,replace:!0}),()=>{d()}},[t,t.history]),pt(()=>{var d;if(typeof window<"u"&&((d=window.__TSR__)!=null&&d.dehydrated)||o.current.router===t&&o.current.mounted)return;o.current={router:t,mounted:!0},(async()=>{try{await t.load()}catch(f){console.error(f)}})()},[t]),pt(()=>{if(s&&!e.isLoading){const d=t.state.location,h=t.state.resolvedLocation,f=h.pathname!==d.pathname;t.emit({type:"onLoad",fromLocation:h,toLocation:d,pathChanged:f})}},[s,t,e.isLoading]),pt(()=>{if(l&&!c){const d=t.state.location,h=t.state.resolvedLocation,f=h.pathname!==d.pathname;t.emit({type:"onBeforeRouteMount",fromLocation:h,toLocation:d,pathChanged:f})}},[c,l,t]),pt(()=>{if(u&&!a){const d=t.state.location,h=t.state.resolvedLocation,f=h.pathname!==d.pathname;if(t.emit({type:"onResolved",fromLocation:h,toLocation:d,pathChanged:f}),t.__store.setState(p=>({...p,status:"idle",resolvedLocation:p.location})),typeof document<"u"&&document.querySelector&&t.state.location.hash!==""){const p=document.getElementById(t.state.location.hash);p&&p.scrollIntoView()}}},[a,u,t]),null}function Je(){const t=et(),o=t.options.defaultPendingComponent?y.jsx(t.options.defaultPendingComponent,{}):null,e=t.isServer||typeof document<"u"&&window.__TSR__?St:S.Suspense,n=y.jsxs(e,{fallback:o,children:[y.jsx(Ge,{}),y.jsx(Xe,{})]});return t.options.InnerWrap?y.jsx(t.options.InnerWrap,{children:n}):n}function Xe(){const t=U({select:e=>{var n;return(n=e.matches[0])==null?void 0:n.id}}),o=U({select:e=>e.loadedAt});return y.jsx(Mt.Provider,{value:t,children:y.jsx(kt,{getResetKey:()=>o,errorComponent:xt,onCatch:e=>{Tt(!1,e.message||e.toString())},children:t?y.jsx(oe,{matchId:t}):null})})}function Qe({router:t,children:o,...e}){t.update({...t.options,...e,context:{...t.options.context,...e.context}});const n=Yt(),r=y.jsx(n.Provider,{value:t,children:o});return t.options.Wrap?y.jsx(t.options.Wrap,{children:r}):r}function cn({router:t,...o}){return y.jsx(Qe,{router:t,...o,children:y.jsx(Je,{})})}export{an as L,Ve as O,cn as R,sn as a,on as b,rn as c,ze as u};
